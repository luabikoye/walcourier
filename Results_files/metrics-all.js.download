/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


var DesktopMetricsCore=function(){this.initialize();};DesktopMetricsCore.prototype={initialize:function(){var _1=this;this.pageLandData=dataLayer[0];this.__stripParams=function(_2){if((_2!=null)&&(_2.lastIndexOf("?")!=-1)){_2=_2.substring(0,_2.lastIndexOf("?"));}return _2;},this.getEcomListClickWrapper=function(_3,_4){return JSON.parse(JSON.stringify({"event":"ecomListClick","ecommerce":{"click":{"actionField":{"list":_3},"products":_4}}}));},this.getTrackInfoFromDataLayer=function(_5){var _6={};_5=_5.trim();if(typeof _1.pageLandData!=="undefined"&&typeof _1.pageLandData.ecommerce!=="undefined"&&typeof _1.pageLandData.ecommerce.impressions!=="undefined"){var _7=_1.pageLandData.ecommerce.impressions;$.each(_7,function(_8,_9){if(typeof _9.id!=="undefined"&&_9.id.toUpperCase()==_5.toUpperCase()){_6=_9;return false;}});}return _6;},this.TrackClickScript=function(e){var _a={};var _b=[];var t={};var _c=e.target;var _d=$(_c).closest("div.container-fluid").find(".tracking-number").text();if(_d!==""){t=_1.getTrackInfoFromDataLayer(_d);delete t["list"];}_b.push(t);_a=_1.getEcomListClickWrapper("Tracking Tool Results",_b);return _a;},this.TrackUpdatesAjaxScript=function(_e,_f,xhr){var _10=this.__transformToAssocArray(_e.data);var _11=_10["label"];var _f={};_f={"event":"availableActions"};var atr={"category":"USPS Tracking Available Actions","action":"Text & Email Updates"};var _12=[];$("form.textAndEmailUpdate input[value=\""+_11+"\"]").parent().find("div[id*=\"checkbox-wrapper\"] div.row").each(function(){var _13={};var tf=$(this).find("input[type=checkbox].text-updates-label")[0];_13["text"]=$(tf).prop("checked")?1:0;var ef=$(this).find("input[type=checkbox].email-updates-label")[0];_13["email"]=$(ef).prop("checked")?1:0;var st=$(ef).closest("div").next().find("span")[0];_13["option"]=$(st).prop("innerText");if(typeof _13["option"]!=="undefined"){_12.push(_13);}});atr["options"]=_12;_f["attribute"]=atr;return _f;},this.clickLandMap={"ScheduleAPickupAction":{"input[name*=dogAnswer]":{"section":"dogalert","event":"GAeventInteraction"},},"TrackConfirmAction":{"#tracked-numbers div.track-bar-container a.tracking-result-collapser":_1.TrackClickScript,"button.getTextUpdates":{"event":"availableActions","attribute":{"category":"USPS Tracking Available Actions","action":"Text Updates"}},"button.getEmailUpdates":{"event":"availableActions","attribute":{"category":"USPS Tracking Available Actions","action":"Email Updates"}},"button.doScheduleRedelivery":{"event":"availableActions","attribute":{"category":"USPS Tracking Available Actions","action":"Schedule Redelivery"}},"button.doProofOfDelivery":{"event":"availableActions","attribute":{"category":"USPS Tracking Available Actions","action":"Proof of Delivery"}},"button.getReturnReceiptEmail":{"event":"availableActions","attribute":{"category":"USPS Tracking Available Actions","action":"Return Receipt"}},"button.submitDuplicate":{"event":"availableActions","attribute":{"category":"USPS Tracking Available Actions","action":"Duplicate"}},"div.diPanel button.white btn-zip-code-search":{"event":"availableActions","attribute":{"category":"USPS Tracking Available Actions","action":"DI Zip Search"}},"div.diPanel button.change-options-btn":{"event":"availableActions","attribute":{"category":"USPS Tracking Available Actions","action":"DI Change Options"}},"div.diPanel button.add-to-cart":{"event":"availableActions","attribute":{"category":"USPS Tracking Available Actions","action":"DI Add to Cart"}},"div.diPanel button.calculatePrice":{"event":"availableActions","attribute":{"category":"USPS Tracking Available Actions","action":"DI Calculate Price"}},"div.diPanel button.continue-delivery":{"event":"availableActions","attribute":{"category":"USPS Tracking Available Actions","action":"DI Continue"}}},},this.ajaxCompleteMap={"TrackConfirmAction":{"TrackConfirmRequestUpdateAJAXAction":_1.TrackUpdatesAjaxScript},},this.actionSynonymMap={"ScheduleAPickupAction!input":"ScheduleAPickupAction"},this.__stripBasePath=function(_14){var _15="";if((_14!=null)&&(_14.lastIndexOf("/")!=-1)){_15=_14.substring(_14.lastIndexOf("/")+1);if((_15!=null)&&(_15.lastIndexOf(".action")!=-1)){_15=_15.substring(0,_15.lastIndexOf(".action"));}if((_15!=null)&&(_15.lastIndexOf("_")!=-1)){_15=_15.substring(0,_15.lastIndexOf("_"));}}return _15;},this.__transformToAssocArray=function(_16){var _17={};var _18=_16.split("&");for(var i=0;i<_18.length;i++){var _19=_18[i].split("=");_17[_19[0]]=_19[1];}return _17;},this.getSearchParameters=function(_1a){if(_1a==null){_1a=window.location.search.substr(1);}return _1a!=null&&_1a!=""?this.__transformToAssocArray(_1a):{};};this.bindEvents=function(_1b,_1c){var _1d=this;var _1e=this.__stripBasePath(window.location.pathname);if((this.actionSynonymMap!==null)&&(typeof this.actionSynonymMap!=="undefined")&&(typeof this.actionSynonymMap[_1e]!=="undefined")){_1e=this.actionSynonymMap[_1e];}var _1f=[_1e];for(var i=0;i<_1f.length;i++){var _20=_1f[i];if(_20!=null){var _21=_1c[_1f[i]];if(_21!==undefined){for(var _22 in _21){if(_21.hasOwnProperty(_22)){var btn=$(_22);if(btn!==null){var td=_21[_22];$(btn).each(function(){$(this).on(_1b,this,handleEvent.bind(_1d,td));});}}}}}}};this.bindAjaxEvents=function(_23){var _24=this;var _25=_24.__stripBasePath(window.location.pathname);if(typeof _24.actionSynonymMap!=="undefined"&&typeof _24.actionSynonymMap[_25]!=="undefined"){_25=_24.actionSynonymMap[_25];}if(typeof _25!=="undefined"){var _26=_23[_25];if(typeof _26!=="undefined"){$(document).on("ajaxComplete",_24,function(_27,xhr,_28){var _29=_24.__stripBasePath(_28.url);_29=_24.__stripParams(_29);thisAjaxHandler=_26[_29];if(typeof thisAjaxHandler!=="undefined"){var md=thisAjaxHandler.bind(_24,_28,_27,xhr)();if(typeof md==="function"){md=md();}if(!$.isEmptyObject(md)){handleEvent.bind(_24,md,_27)();}}});}}};}};var GTMCore=function(){this.initialize();};function handleEvent(_2a,e){if(this.userEvent!==undefined){this.userEvent(_2a,e);}};GTMCore.prototype={initialize:function(){this.userEvent=function(_2b,e){if(typeof dataLayer!=="undefined"){if(_2b!==null&&_2b!==undefined){if(typeof _2b=="function"){_2b=_2b(e);}if(_2b!==null&&_2b!==undefined){dataLayer.push(_2b);}}}};}};$(document).ready(function(){var dmc=new DesktopMetricsCore();var _2c=new GTMCore();$.extend(dmc,_2c);dmc.bindEvents("click",dmc.clickLandMap);dmc.bindAjaxEvents(dmc.ajaxCompleteMap);});